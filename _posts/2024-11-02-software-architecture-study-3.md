---
title: 소프트웨어 설계의 정석 스터디 - 3
author: Ariel
date: 2024-11-23 14:50:00 +0900
categories: [Study, Software Architecture]
tags: [Algorithm, Software Architecture, agile, waterfall]
---
이 포스트는 '소프트웨어 설계의 정석(한빛미디어)' 도서를 읽고 작성했습니다.
---

# 내부 설계
> 상세 설계라고도 부름<br>
> 시스템의 입력과 출력, 데이터베이스에 저장하는 사이에 이루어 지는 시스템 내부 처리를 설계 

## 내부 설계란
* 내부 설계의 목적
  * 요구사항 정의의 내용을 시스템에서 어떻게 구현할 것인가를 검토
* 내부 설계의 주요 작업
  * 화면 프로그램 설계
  * 비즈니스 로직 프로그램 설계
  * 데이터베이스 프로그램 설계
  * 데이터베이스 물리 설계
  * 테스트를 위한 설계

## 1. 화면 프로그램 설계
* 화면 설계에서 작성한 화면 전환도, 화면 목업, 화면 항목 정의서를 바탕으로 화면의 프로그램 설계를 진행
* 책에서는 스프링부트와 타임리프를 사용한 화면 프로그램 설계를 설명
* 프론트를 별도의 서버로 구축하여 리액트 등을 사용하는 경우로 치환하면 아래와 같이 진행
1. API 엔드포인트 설계 (화면에서 필요한 데이터를 제공하는 API 설계, 책에서의 컨트롤러 역할)
   1. 화면 전환 다이어그램에서 필요한 데이터를 제공하는 API를 추출
   2. 목록에 나열된 각 API에서 수행할 처리를 설계
2. 화면 공통 요소 설계
   1. 공통 컴포넌트를 정의하고 설계 진행
3. HTTP 세션 설계
   1. 로그인 인증등의 세션 정보를 어떻게 전달하고 관리할 것인지 설계
   2. 세션을 이용하는 경우 세션 키를 쿠키에 저장하는 방법을 설계
   3. 세션을 이용하지 않는 경우 JWT(Json Web Token)을 사용하여 인증을 처리하는 방법을 설계

## 2. 비즈니스 로직 프로그램 설계
> 비즈니스 로직은 유스케이스 작성이나 비즈니스 규칙으로 작성된 업무에 관한 시스템의 처리<br>
> 도메인 로직이라고 부르기도 함

1. 트랜잭션 스크립트 패턴
   * 비즈니스 로직을 Service 클래스의 메소드로 구현
   * 트랜잭션 스크립트는 비즈니스 로직을 메서드로만 모아놓으며, 속성 등의 상태를 갖지 않음
   * POJO로 구현할 수 있음
   * 설계가 간단함
   * 비즈니스 로직의 처리를 공통화하도록 설계하는 것이 어려움
   * 트랜잭션 스크립트에서는 엔터티와 관련된 다형성을 구현할 수 없음
2. 도메인 모델 패턴
   * 도메인 모델은 엔터티에 비즈니스 로직을 부여
   * 개념 모델에서 추출된 엔터티에 자연스러운 형태로 비즈니스 로직을 배치할 수 있음
   * 엔터티 간에 강한 종속성이 발생함
   * 엔터티가 복잡해질 가능성이 있음
   * 전략 패턴 등을 이용하여 엔터티의 비즈니스 로직을 분리하는 것이 좋음

## 3. 데이터베이스 프로그램 설계
1. ORM의 필요성
   * ORM(Object Relational Mapping)은 객체와 관계형 데이터베이스 간의 매핑을 자동으로 처리하는 프레임워크
   * 특정 데이터베이스 제품에 프로그램이 의존하지 않도록 함
2. DAO 패턴 사용하기
   * 영속화되는 객체에서 영속화 처리를 분리하여 DAO 클래스포 은폐하기 위한 패턴
   * DAO를 이용하면 영속화할 객체를 POJO로 취급할 수 있음
   * 데이터베이스에 영속화 되는 객체를 만들어 개념 모델에 등장하는 객체로 사용할 수 있으며, 이를 엔터티라 함
3. 엔터티 클래스 다이어그램 작성
   * 개념 모델의 한글 클래스명을 영어 클래스명으로 변경하기
   * 개념 모델의 한글 속성명을 영어 속성명으로 변경하기
   * 접근자 메서드 추가하기
   * 클래스 간 연관성에 방향(화살표) 부여하기
4. DAO 클래스 다이어그램 작성
   * 하나의 엔터티에 대해 하나의 DAO 클래스를 작성
   * DAO에는 CRUD(Create, Read, Update, Delete) 메서드와 find 메서드를 작성
5. 트랜잭션 제어
   * 데이터베이스 프로그래밍에서 트랜잭션 제어를 고려하는 것은 중요함
   * 트랜잭션 제어를 통해 데이터베이스 작업이 오류가 났을 때 롤백 조작을 할 수 있음
   * 데이터의 무결성을 항상 유지할 수 있도록 함
   * 트랜잭션 격리 수준과 트랜잭션 범위를 항상 주의하여 설계해야 함
6. 데이터베이스 락(lock)
   * 데이터베이스 락은 데이터베이스의 동시성 제어를 위해 사용
   * 사용하는 데이터베이스에 따라 적용되는 락의 차이가 다소 있을 수 있음
   * 락을 사용하여 데이터베이스의 동시성을 제어하면 데이터의 무결성을 유지할 수 있음
7. 커넥션 풀
   * 데이터베이스와의 연결을 효율적으로 관리하기 위해 커넥션 풀을 사용
8. 마스터의 캐시
   * 데이터베이스의 성능을 향상시키기 위해 캐시를 사용
   * DB의 파일 I/O 작업을 줄여 성능을 향상시킬 수 있음

## 4. 데이터베이스 물리 설계
1. 물리 ER 다이어그램 작성
   * 데이터베이스 논리 설계 단계에서 생성한 논리 ER 다이어그램으로 물리 ER 다이어그램을 생성하고 테이블 정의서를 작성
   * 물리 ER 다이어그램을 생성하기위해 다음을 수행
     1. 테이블 이름과 칼럼 이름을 영어로 표기
     2. 칼럼의 종류와 크기를 지정
     3. 성능 설계를 수행
2. 성능 설계
   * 데이터베이스 물리 설계에서 가장 중요
   * 정규화, 인덱스, 파티셔닝, 샤딩 등을 사용하여 성능을 향상시킬 수 있음
   * 데이터베이스 설계 단계에서 성능을 고려하여 설계하면 추후 성능 튜닝이 용이함
3. 테이블 정의서 작성
   * 물리 ER 다이어그램을 바탕으로 테이블 정의서를 작성
## 5. 테스트를 위한 설계
1. 테스트 및 설계
   * 테스트는 보통 세 가지 단계로 나누어짐
     * 단위 테스트
     * 통합 테스트
     * 시스템 테스트
2. TDD
   * 테스트 주도 개발
   * 테스트 케이스를 먼저 작성한 후 프로그램을 구현
   * 주로 블랙박스 테스트를 수행하기 위해 사용하는 기법
   * XP와 같은 짧은 주기의 애자일 프로젝트에서 사용하면 부족한 설계 시간과 테스트 시간을 보완할 수 있음
   * TDD와 테스트 자동화를 함께 사용해야 지속적으로 테스트를 유의미하게 사용 가능

## 6. 개발 환경 구축
* IDE, CI/CD, 빌드 툴, 버전 관리 시스템 등을 구축하여 개발 환경을 구축
* 일관적인 개발환경을 제공하여 개발자들이 효율적으로 개발할 수 있도록 함

## 7. 개발 표준 수립
* 코딩 컨벤션을 정의하여 개발자들이 일관된 코딩 스타일을 유지할 수 있도록 함
* 일관된 코딩 컨벤션은 코드의 가독성을 높이고 유지보수성을 향상시킴
* 개발 표준은 하향식으로 정하기 보다는 전 구성원이 참여하여 정하는 것이 좋음
* 필요에 따라 잘 알려진 빅테크 기업의 표준을 차용하여 사용하기도 함
